<ion-header>
    <ion-navbar >
      <ion-title *ngIf="partner"><b>{{ partner.payload.val().username }}</b></ion-title>
      <ion-buttons start>
        <button ion-button tappable (click)="navCtrl.pop()"><ion-icon name="icon-close"></ion-icon></button>
      </ion-buttons>
      <ion-buttons end>
        <button ion-button tappable (click)="viewProfile(partner.userId)"><ion-icon name="icon-user"></ion-icon></button>
      </ion-buttons>
    </ion-navbar>
  </ion-header>
  <ion-content>
    <ion-refresher *ngIf="conversation" (ionRefresh)="onRefresh($event)" [enabled]="messagesToShow < conversation.messages.length" snapbackDuration="500" closeDuration="500">
      <ion-refresher-content pullingIcon="none"
        pullingText=""
        refreshingSpinner="circles"
        refreshingText=""></ion-refresher-content>
    </ion-refresher>
    <div *ngIf="conversation" no-margin no-padding>
      <ion-row *ngFor="let message of conversation.messages | slice:from:conversation.messages.length; last as last; index as index" tappable>
        <ion-col class="profile" col-2 text-center *ngIf="message.sender == partner.key" tappable (click)="viewProfile(partner.key); $event.stopPropagation();"><img src="{{ partner.payload.val().profileImg }}" ></ion-col>
        <ion-col class="message" col-10 *ngIf="message.sender == 'chatInitializer'">
            <p text-wrap float-center *ngIf="message.type == 'text'">{{ message.message }}</p>
            
          </ion-col>
        <ion-col class="message" col-10 *ngIf="message.sender == partner.key">
          <p text-wrap float-left *ngIf="message.type == 'text'">{{ message.message }}</p>
          
        </ion-col>
        <ion-col class="sender" *ngIf="message.sender ==  this.user.key">
          <p text-wrap float-right *ngIf="message.type == 'text'">{{ message.message }}</p>
         
        </ion-col>
        <ion-col col-12 class="date">
          <p class="other" *ngIf="message.sender == partner.key" text-left>{{ message.date | DateFormat }}</p>
          <p *ngIf="message.sender != partner.key" text-right>{{ message.date | DateFormat }}</p>
        </ion-col>
      </ion-row>
    </div>
  </ion-content>
  <ion-footer [ngClass]="{'iPhoneX': iPhoneX, 'android': android}">
    <div>
      <ion-textarea #messageBox id="messageBox" fz-elastic type="text" [placeholder]="translate.get('chats.message.write')" [(ngModel)]="message" rows="1" (keydown)="onType($event)" (ionBlur)="onBlur()" (ionFocus)="onFocus()"></ion-textarea>
   
      <button ion-button icon-only clear (click)="send()" *ngIf="message" ><ion-icon name="paper-plane"></ion-icon></button>
    </div>
  </ion-footer>
  